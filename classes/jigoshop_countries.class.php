<?php
/**
 * Internationalization
 *
 * The JigoShop countries class stores country/state data.
 *
 * DISCLAIMER
 *
 * Do not edit or add directly to this file if you wish to upgrade Jigoshop to newer
 * versions in the future. If you wish to customise Jigoshop core for your needs,
 * please use our GitHub repository to publish essential changes for consideration.
 *
 * @package    Jigoshop
 * @category   Internationalization
 * @author     Jigowatt
 * @copyright  Copyright (c) 2011 Jigowatt Ltd.
 * @license    http://jigoshop.com/license/commercial-edition
 */
class jigoshop_countries {

	public static $countries = array(
			'AF' => __('Afghanistan', 'jigoshop'),
			'AX' => __('Aland Islands', 'jigoshop'),
			'AL' => __('Albania', 'jigoshop'),
			'DZ' => __('Algeria', 'jigoshop'),
			'AS' => __('American Samoa', 'jigoshop'),
			'AD' => __('Andorra', 'jigoshop'),
			'AO' => __('Angola', 'jigoshop'),
			'AI' => __('Anguilla', 'jigoshop'),
			'AQ' => __('Antarctica', 'jigoshop'),
			'AG' => __('Antigua and Barbuda', 'jigoshop'),
			'AR' => __('Argentina', 'jigoshop'),
			'AM' => __('Armenia', 'jigoshop'),
			'AW' => __('Aruba', 'jigoshop'),
			'AU' => __('Australia', 'jigoshop'),
			'AT' => __('Austria', 'jigoshop'),
			'AZ' => __('Azerbaijan', 'jigoshop'),
			'BS' => __('Bahamas', 'jigoshop'),
			'BH' => __('Bahrain', 'jigoshop'),
			'BD' => __('Bangladesh', 'jigoshop'),
			'BB' => __('Barbados', 'jigoshop'),
			'BY' => __('Belarus', 'jigoshop'),
			'BE' => __('Belgium', 'jigoshop'),
			'BZ' => __('Belize', 'jigoshop'),
			'BJ' => __('Benin', 'jigoshop'),
			'BM' => __('Bermuda', 'jigoshop'),
			'BT' => __('Bhutan', 'jigoshop'),
			'BO' => __('Bolivia', 'jigoshop'),
			'BA' => __('Bosnia and Herzegovina', 'jigoshop'),
			'BW' => __('Botswana', 'jigoshop'),
			'BR' => __('Brazil', 'jigoshop'),
			'IO' => __('British Indian Ocean Territory', 'jigoshop'),
			'VG' => __('British Virgin Islands', 'jigoshop'),
			'BN' => __('Brunei', 'jigoshop'),
			'BG' => __('Bulgaria', 'jigoshop'),
			'BF' => __('Burkina Faso', 'jigoshop'),
			'BI' => __('Burundi', 'jigoshop'),
			'KH' => __('Cambodia', 'jigoshop'),
			'CM' => __('Cameroon', 'jigoshop'),
			'CA' => __('Canada', 'jigoshop'),
			'CV' => __('Cape Verde', 'jigoshop'),
			'KY' => __('Cayman Islands', 'jigoshop'),
			'CF' => __('Central African Republic', 'jigoshop'),
			'TD' => __('Chad', 'jigoshop'),
			'CL' => __('Chile', 'jigoshop'),
			'CN' => __('China', 'jigoshop'),
			'CX' => __('Christmas Island', 'jigoshop'),
			'CC' => __('Cocos (Keeling) Islands', 'jigoshop'),
			'CO' => __('Colombia', 'jigoshop'),
			'KM' => __('Comoros', 'jigoshop'),
			'CG' => __('Congo (Brazzaville)', 'jigoshop'),
			'CD' => __('Congo (Kinshasa)', 'jigoshop'),
			'CK' => __('Cook Islands', 'jigoshop'),
			'CR' => __('Costa Rica', 'jigoshop'),
			'HR' => __('Croatia', 'jigoshop'),
			'CU' => __('Cuba', 'jigoshop'),
			'CY' => __('Cyprus', 'jigoshop'),
			'CZ' => __('Czech Republic', 'jigoshop'),
			'DK' => __('Denmark', 'jigoshop'),
			'DJ' => __('Djibouti', 'jigoshop'),
			'DM' => __('Dominica', 'jigoshop'),
			'DO' => __('Dominican Republic', 'jigoshop'),
			'EC' => __('Ecuador', 'jigoshop'),
			'EG' => __('Egypt', 'jigoshop'),
			'SV' => __('El Salvador', 'jigoshop'),
			'GQ' => __('Equatorial Guinea', 'jigoshop'),
			'ER' => __('Eritrea', 'jigoshop'),
			'EE' => __('Estonia', 'jigoshop'),
			'ET' => __('Ethiopia', 'jigoshop'),
			'FK' => __('Falkland Islands', 'jigoshop'),
			'FO' => __('Faroe Islands', 'jigoshop'),
			'FJ' => __('Fiji', 'jigoshop'),
			'FI' => __('Finland', 'jigoshop'),
			'FR' => __('France', 'jigoshop'),
			'GF' => __('French Guiana', 'jigoshop'),
			'PF' => __('French Polynesia', 'jigoshop'),
			'TF' => __('French Southern Territories', 'jigoshop'),
			'GA' => __('Gabon', 'jigoshop'),
			'GM' => __('Gambia', 'jigoshop'),
			'GE' => __('Georgia', 'jigoshop'),
			'DE' => __('Germany', 'jigoshop'),
			'GH' => __('Ghana', 'jigoshop'),
			'GI' => __('Gibraltar', 'jigoshop'),
			'GR' => __('Greece', 'jigoshop'),
			'GL' => __('Greenland', 'jigoshop'),
			'GD' => __('Grenada', 'jigoshop'),
			'GP' => __('Guadeloupe', 'jigoshop'),
			'GU' => __('Guam', 'jigoshop'),
			'GT' => __('Guatemala', 'jigoshop'),
			'GG' => __('Guernsey', 'jigoshop'),
			'GN' => __('Guinea', 'jigoshop'),
			'GW' => __('Guinea-Bissau', 'jigoshop'),
			'GY' => __('Guyana', 'jigoshop'),
			'HT' => __('Haiti', 'jigoshop'),
			'HN' => __('Honduras', 'jigoshop'),
			'HK' => __('Hong Kong', 'jigoshop'),
			'HU' => __('Hungary', 'jigoshop'),
			'IS' => __('Iceland', 'jigoshop'),
			'IN' => __('India', 'jigoshop'),
			'ID' => __('Indonesia', 'jigoshop'),
			'IR' => __('Iran', 'jigoshop'),
			'IQ' => __('Iraq', 'jigoshop'),
			'IE' => __('Ireland', 'jigoshop'),
			'IM' => __('Isle of Man', 'jigoshop'),
			'IL' => __('Israel', 'jigoshop'),
			'IT' => __('Italy', 'jigoshop'),
			'CI' => __('Ivory Coast', 'jigoshop'),
			'JM' => __('Jamaica', 'jigoshop'),
			'JP' => __('Japan', 'jigoshop'),
			'JE' => __('Jersey', 'jigoshop'),
			'JO' => __('Jordan', 'jigoshop'),
			'KZ' => __('Kazakhstan', 'jigoshop'),
			'KE' => __('Kenya', 'jigoshop'),
			'KI' => __('Kiribati', 'jigoshop'),
			'KW' => __('Kuwait', 'jigoshop'),
			'KG' => __('Kyrgyzstan', 'jigoshop'),
			'LA' => __('Laos', 'jigoshop'),
			'LV' => __('Latvia', 'jigoshop'),
			'LB' => __('Lebanon', 'jigoshop'),
			'LS' => __('Lesotho', 'jigoshop'),
			'LR' => __('Liberia', 'jigoshop'),
			'LY' => __('Libya', 'jigoshop'),
			'LI' => __('Liechtenstein', 'jigoshop'),
			'LT' => __('Lithuania', 'jigoshop'),
			'LU' => __('Luxembourg', 'jigoshop'),
			'MO' => __('Macao S.A.R., China', 'jigoshop'),
			'MK' => __('Macedonia', 'jigoshop'),
			'MG' => __('Madagascar', 'jigoshop'),
			'MW' => __('Malawi', 'jigoshop'),
			'MY' => __('Malaysia', 'jigoshop'),
			'MV' => __('Maldives', 'jigoshop'),
			'ML' => __('Mali', 'jigoshop'),
			'MT' => __('Malta', 'jigoshop'),
			'MH' => __('Marshall Islands', 'jigoshop'),
			'MQ' => __('Martinique', 'jigoshop'),
			'MR' => __('Mauritania', 'jigoshop'),
			'MU' => __('Mauritius', 'jigoshop'),
			'YT' => __('Mayotte', 'jigoshop'),
			'MX' => __('Mexico', 'jigoshop'),
			'FM' => __('Micronesia', 'jigoshop'),
			'MD' => __('Moldova', 'jigoshop'),
			'MC' => __('Monaco', 'jigoshop'),
			'MN' => __('Mongolia', 'jigoshop'),
			'ME' => __('Montenegro', 'jigoshop'),
			'MS' => __('Montserrat', 'jigoshop'),
			'MA' => __('Morocco', 'jigoshop'),
			'MZ' => __('Mozambique', 'jigoshop'),
			'MM' => __('Myanmar', 'jigoshop'),
			'NA' => __('Namibia', 'jigoshop'),
			'NR' => __('Nauru', 'jigoshop'),
			'NP' => __('Nepal', 'jigoshop'),
			'NL' => __('Netherlands', 'jigoshop'),
			'AN' => __('Netherlands Antilles', 'jigoshop'),
			'NC' => __('New Caledonia', 'jigoshop'),
			'NZ' => __('New Zealand', 'jigoshop'),
			'NI' => __('Nicaragua', 'jigoshop'),
			'NE' => __('Niger', 'jigoshop'),
			'NG' => __('Nigeria', 'jigoshop'),
			'NU' => __('Niue', 'jigoshop'),
			'NF' => __('Norfolk Island', 'jigoshop'),
			'KP' => __('North Korea', 'jigoshop'),
			'MP' => __('Northern Mariana Islands', 'jigoshop'),
			'NO' => __('Norway', 'jigoshop'),
			'OM' => __('Oman', 'jigoshop'),
			'PK' => __('Pakistan', 'jigoshop'),
			'PW' => __('Palau', 'jigoshop'),
			'PS' => __('Palestinian Territory', 'jigoshop'),
			'PA' => __('Panama', 'jigoshop'),
			'PG' => __('Papua New Guinea', 'jigoshop'),
			'PY' => __('Paraguay', 'jigoshop'),
			'PE' => __('Peru', 'jigoshop'),
			'PH' => __('Philippines', 'jigoshop'),
			'PN' => __('Pitcairn', 'jigoshop'),
			'PL' => __('Poland', 'jigoshop'),
			'PT' => __('Portugal', 'jigoshop'),
			'PR' => __('Puerto Rico', 'jigoshop'),
			'QA' => __('Qatar', 'jigoshop'),
			'RE' => __('Reunion', 'jigoshop'),
			'RO' => __('Romania', 'jigoshop'),
			'RU' => __('Russia', 'jigoshop'),
			'RW' => __('Rwanda', 'jigoshop'),
			'BL' => __('Saint BarthÃ©lemy', 'jigoshop'),
			'SH' => __('Saint Helena', 'jigoshop'),
			'KN' => __('Saint Kitts and Nevis', 'jigoshop'),
			'LC' => __('Saint Lucia', 'jigoshop'),
			'MF' => __('Saint Martin (French part)', 'jigoshop'),
			'PM' => __('Saint Pierre and Miquelon', 'jigoshop'),
			'VC' => __('Saint Vincent and the Grenadines', 'jigoshop'),
			'WS' => __('Samoa', 'jigoshop'),
			'SM' => __('San Marino', 'jigoshop'),
			'ST' => __('Sao Tome and Principe', 'jigoshop'),
			'SA' => __('Saudi Arabia', 'jigoshop'),
			'SN' => __('Senegal', 'jigoshop'),
			'RS' => __('Serbia', 'jigoshop'),
			'SC' => __('Seychelles', 'jigoshop'),
			'SL' => __('Sierra Leone', 'jigoshop'),
			'SG' => __('Singapore', 'jigoshop'),
			'SK' => __('Slovakia', 'jigoshop'),
			'SI' => __('Slovenia', 'jigoshop'),
			'SB' => __('Solomon Islands', 'jigoshop'),
			'SO' => __('Somalia', 'jigoshop'),
			'ZA' => __('South Africa', 'jigoshop'),
			'GS' => __('South Georgia/Sandwich Islands', 'jigoshop'),
			'KR' => __('South Korea', 'jigoshop'),
			'ES' => __('Spain', 'jigoshop'),
			'LK' => __('Sri Lanka', 'jigoshop'),
			'SD' => __('Sudan', 'jigoshop'),
			'SR' => __('Suriname', 'jigoshop'),
			'SJ' => __('Svalbard and Jan Mayen', 'jigoshop'),
			'SZ' => __('Swaziland', 'jigoshop'),
			'SE' => __('Sweden', 'jigoshop'),
			'CH' => __('Switzerland', 'jigoshop'),
			'SY' => __('Syria', 'jigoshop'),
			'TW' => __('Taiwan', 'jigoshop'),
			'TJ' => __('Tajikistan', 'jigoshop'),
			'TZ' => __('Tanzania', 'jigoshop'),
			'TH' => __('Thailand', 'jigoshop'),
			'TL' => __('Timor-Leste', 'jigoshop'),
			'TG' => __('Togo', 'jigoshop'),
			'TK' => __('Tokelau', 'jigoshop'),
			'TO' => __('Tonga', 'jigoshop'),
			'TT' => __('Trinidad and Tobago', 'jigoshop'),
			'TN' => __('Tunisia', 'jigoshop'),
			'TR' => __('Turkey', 'jigoshop'),
			'TM' => __('Turkmenistan', 'jigoshop'),
			'TC' => __('Turks and Caicos Islands', 'jigoshop'),
			'TV' => __('Tuvalu', 'jigoshop'),
			'VI' => __('U.S. Virgin Islands', 'jigoshop'),
			'USAF' => __('US Armed Forces', 'jigoshop'),
			'UM' => __('US Minor Outlying Islands', 'jigoshop'),
			'UG' => __('Uganda', 'jigoshop'),
			'UA' => __('Ukraine', 'jigoshop'),
			'AE' => __('United Arab Emirates', 'jigoshop'),
			'GB' => __('United Kingdom', 'jigoshop'),
			'US' => __('United States', 'jigoshop'),
			'UY' => __('Uruguay', 'jigoshop'),
			'UZ' => __('Uzbekistan', 'jigoshop'),
			'VU' => __('Vanuatu', 'jigoshop'),
			'VA' => __('Vatican', 'jigoshop'),
			'VE' => __('Venezuela', 'jigoshop'),
			'VN' => __('Vietnam', 'jigoshop'),
			'WF' => __('Wallis and Futuna', 'jigoshop'),
			'EH' => __('Western Sahara', 'jigoshop'),
			'YE' => __('Yemen', 'jigoshop'),
			'ZM' => __('Zambia', 'jigoshop'),
			'ZW' => __('Zimbabwe', 'jigoshop')
	);

	public static $states = array(
		'AU' => array(
			'ACT' => __('Australian Capital Territory', 'jigoshop') ,
			'NSW' => __('New South Wales', 'jigoshop') ,
			'NT' => __('Northern Territory', 'jigoshop') ,
			'QLD' => __('Queensland', 'jigoshop') ,
			'SA' => __('South Australia', 'jigoshop') ,
			'TAS' => __('Tasmania', 'jigoshop') ,
			'VIC' => __('Victoria', 'jigoshop') ,
			'WA' => __('Western Australia', 'jigoshop')
		),
		'AT' => array(),
		'BR' => array(
			'AM' => __('Amazonas', 'jigoshop'),
			'AC' => __('Acre', 'jigoshop'),
			'AL' => __('Alagoas', 'jigoshop'),
			'AP' => __('Amap&aacute;', 'jigoshop'),
			'CE' => __('Cear&aacute;', 'jigoshop'),
			'DF' => __('Distrito federal', 'jigoshop'),
			'ES' => __('Espirito santo', 'jigoshop'),
			'MA' => __('Maranh&atilde;o', 'jigoshop'),
			'PR' => __('Paran&aacute;', 'jigoshop'),
			'PE' => __('Pernambuco', 'jigoshop'),
			'PI' => __('Piau&iacute;', 'jigoshop'),
			'RN' => __('Rio grande do norte', 'jigoshop'),
			'RS' => __('Rio grande do sul', 'jigoshop'),
			'RO' => __('Rond&ocirc;nia', 'jigoshop'),
			'RR' => __('Roraima', 'jigoshop'),
			'SC' => __('Santa catarina', 'jigoshop'),
			'SE' => __('Sergipe', 'jigoshop'),
			'TO' => __('Tocantins', 'jigoshop'),
			'PA' => __('Par&aacute;', 'jigoshop'),
			'BH' => __('Bahia', 'jigoshop'),
			'GO' => __('Goi&aacute;s', 'jigoshop'),
			'MT' => __('Mato grosso', 'jigoshop'),
			'MS' => __('Mato grosso do sul', 'jigoshop'),
			'RJ' => __('Rio de janeiro', 'jigoshop'),
			'SP' => __('S&atilde;o paulo', 'jigoshop'),
			'RS' => __('Rio grande do sul', 'jigoshop'),
			'MG' => __('Minas gerais', 'jigoshop'),
			'PB' => __('Paraiba', 'jigoshop'),
		),
		'CA' => array(
			'AB' => __('Alberta', 'jigoshop') ,
			'BC' => __('British Columbia', 'jigoshop') ,
			'MB' => __('Manitoba', 'jigoshop') ,
			'NB' => __('New Brunswick', 'jigoshop') ,
			'NF' => __('Newfoundland', 'jigoshop') ,
			'NT' => __('Northwest Territories', 'jigoshop') ,
			'NS' => __('Nova Scotia', 'jigoshop') ,
			'NU' => __('Nunavut', 'jigoshop') ,
			'ON' => __('Ontario', 'jigoshop') ,
			'PE' => __('Prince Edward Island', 'jigoshop') ,
			'PQ' => __('Quebec', 'jigoshop') ,
			'SK' => __('Saskatchewan', 'jigoshop') ,
			'YT' => __('Yukon Territory', 'jigoshop')
		),
		'CZ' => array(),
		'DE' => array(),
		'DK' => array(),
		'FI' => array(),
		'FR' => array(),
		'HK' => array(
			'HONG KONG' => __('Hong Kong Island', 'jigoshop'),
			'KOWLOONG' => __('Kowloong', 'jigoshop'),
			'NEW TERRITORIES' => __('New Territories', 'jigoshop')
		),
		'HU' => array(),
		'IS' => array(),
		'IL' => array(),
		'NL' => array(),
		'NZ' => array(),
		'NO' => array(),
		'PL' => array(),
		'SG' => array(),
		'SK' => array(),
		'SI' => array(),
		'LK' => array(),
		'SE' => array(),
		'US' => array(
			'AL' => __('Alabama', 'jigoshop') ,
			'AK' => __('Alaska', 'jigoshop') ,
			'AZ' => __('Arizona', 'jigoshop') ,
			'AR' => __('Arkansas', 'jigoshop') ,
			'CA' => __('California', 'jigoshop') ,
			'CO' => __('Colorado', 'jigoshop') ,
			'CT' => __('Connecticut', 'jigoshop') ,
			'DE' => __('Delaware', 'jigoshop') ,
			'DC' => __('District Of Columbia', 'jigoshop') ,
			'FL' => __('Florida', 'jigoshop') ,
			'GA' => __('Georgia', 'jigoshop') ,
			'HI' => __('Hawaii', 'jigoshop') ,
			'ID' => __('Idaho', 'jigoshop') ,
			'IL' => __('Illinois', 'jigoshop') ,
			'IN' => __('Indiana', 'jigoshop') ,
			'IA' => __('Iowa', 'jigoshop') ,
			'KS' => __('Kansas', 'jigoshop') ,
			'KY' => __('Kentucky', 'jigoshop') ,
			'LA' => __('Louisiana', 'jigoshop') ,
			'ME' => __('Maine', 'jigoshop') ,
			'MD' => __('Maryland', 'jigoshop') ,
			'MA' => __('Massachusetts', 'jigoshop') ,
			'MI' => __('Michigan', 'jigoshop') ,
			'MN' => __('Minnesota', 'jigoshop') ,
			'MS' => __('Mississippi', 'jigoshop') ,
			'MO' => __('Missouri', 'jigoshop') ,
			'MT' => __('Montana', 'jigoshop') ,
			'NE' => __('Nebraska', 'jigoshop') ,
			'NV' => __('Nevada', 'jigoshop') ,
			'NH' => __('New Hampshire', 'jigoshop') ,
			'NJ' => __('New Jersey', 'jigoshop') ,
			'NM' => __('New Mexico', 'jigoshop') ,
			'NY' => __('New York', 'jigoshop') ,
			'NC' => __('North Carolina', 'jigoshop') ,
			'ND' => __('North Dakota', 'jigoshop') ,
			'OH' => __('Ohio', 'jigoshop') ,
			'OK' => __('Oklahoma', 'jigoshop') ,
			'OR' => __('Oregon', 'jigoshop') ,
			'PA' => __('Pennsylvania', 'jigoshop') ,
			'RI' => __('Rhode Island', 'jigoshop') ,
			'SC' => __('South Carolina', 'jigoshop') ,
			'SD' => __('South Dakota', 'jigoshop') ,
			'TN' => __('Tennessee', 'jigoshop') ,
			'TX' => __('Texas', 'jigoshop') ,
			'UT' => __('Utah', 'jigoshop') ,
			'VT' => __('Vermont', 'jigoshop') ,
			'VA' => __('Virginia', 'jigoshop') ,
			'WA' => __('Washington', 'jigoshop') ,
			'WV' => __('West Virginia', 'jigoshop') ,
			'WI' => __('Wisconsin', 'jigoshop') ,
			'WY' => __('Wyoming', 'jigoshop')
		),
		'USAF' => array(
			'AA' => __('Americas', 'jigoshop') ,
			'AE' => __('Europe', 'jigoshop') ,
			'AP' => __('Pacific', 'jigoshop')
		)
	);

    static function country_has_states($country_code) {

        return isset(self::$states[$country_code]);
    }

	/** get base country */
	static function get_base_country() {
		$default = get_option('jigoshop_default_country');
    	if (strstr($default, ':')) :
    		$country = current(explode(':', $default));
    		$state = end(explode(':', $default));
    	else :
    		$country = $default;
    		$state = '*';
    	endif;

		return $country;
	}

	/** get base state */
	static function get_base_state() {
		$default = get_option('jigoshop_default_country');
    	if (strstr($default, ':')) :
    		$country = current(explode(':', $default));
    		$state = end(explode(':', $default));
    	else :
    		$country = $default;
    		$state = '*';
    	endif;

		return $state;
	}

	/** get countries we allow only */
	function get_allowed_countries() {

		$countries = self::$countries;

		asort($countries);

		if (get_option('jigoshop_allowed_countries')!=='specific') return $countries;

		$allowed_countries = array();

		$allowed_countries_raw = get_option('jigoshop_specific_allowed_countries');

		foreach ($allowed_countries_raw as $country) :

			$allowed_countries[$country] = $countries[$country];

		endforeach;

		asort($allowed_countries);

		return $allowed_countries;
	}

	/** Gets the correct string for shipping - ether 'to the' or 'to' */
	function shipping_to_prefix() {
		$return = '';
		if (in_array(jigoshop_customer::get_country(), array( 'GB', 'US', 'AE', 'CZ', 'DO', 'NL', 'PH', 'USAF' ))) $return = __('to the', 'jigoshop');
		else $return = __('to', 'jigoshop');
		$return = apply_filters('shipping_to_prefix', $return, jigoshop_customer::get_shipping_country());
		return $return;
	}

	function estimated_for_prefix() {
		$return = '';
		if (in_array(jigoshop_customer::get_country(), array( 'GB', 'US', 'AE', 'CZ', 'DO', 'NL', 'PH', 'USAF' ))) $return = __('the ', 'jigoshop');
		$return = apply_filters('estimated_for_prefix', $return, jigoshop_customer::get_shipping_country());
		return $return;
	}

	/** get states */
	function get_states( $cc ) {
		if (isset( self::$states[$cc] )) return self::$states[$cc];
	}

	/** Outputs the list of countries and states for use in dropdown boxes */
	function country_dropdown_options( $selected_country = '', $selected_state = '*', $escape=false ) {

		$countries = self::$countries;
		asort($countries);

		if ( $countries ) foreach ( $countries as $key=>$value ) :
			$value = esc_js($value);
			if ( $states =  self::get_states($key) ) :
				echo '<optgroup label="'.$value.'">';
    			echo '<option value="'.esc_attr($key).'"';
    			if ($selected_country==$key && $selected_state=='*') echo ' selected="selected"';
    			echo '>'.$value.' &mdash; '.__('All states', 'jigoshop').'</option>';
    			foreach ($states as $state_key=>$state_value) :
    				echo '<option value="'.$key.':'.$state_key.'"';

    				if ($selected_country==$key && $selected_state==$state_key) echo ' selected="selected"';

    				echo '>'.$value.' &mdash; '. ($escape ? esc_js($state_value) : $state_value) .'</option>';
    			endforeach;
    			echo '</optgroup>';
			else :
    			echo '<option';
    			if ($selected_country==$key && $selected_state=='*') echo ' selected="selected"';
    			echo ' value="'.esc_attr($key).'">'. ($escape ? esc_js( __($value, 'jigoshop') ) : __($value, 'jigoshop') ) .'</option>';
			endif;
		endforeach;
	}
}

